\chapter{Introduction}
%Besoin des simu car contraintes observationnelles sur IGM mais impact fort sur les galaxies, pas le même timing, physique complexe il faut simulaer

D'une manière générale, la méthode scientifique repose sur 3 piliers: 
\begin{enumerate}
\item L'observation
\item La théorie
\item L'expérience
\end{enumerate}
L'astrophysique moderne n’échappe pas à cette règle.

\paragraph{L'observation} est le plus ancien des piliers, et constitue le point de départ de toute démarche scientifique.
L'Homme a toujours regardé le ciel, et avant même de chercher à le comprendre, il a recueilli des informations à son sujet. %le regarder et l'analyser.
Contrairement aux autres discipline scientifique, le point de vue que nous avons sur notre sujet d'analyse est unique, il nous est impossible d'observer l'Univers sous un autre angle.
%Les techniques d'observations ont fait d’énormes progrès ces dernières années, mais observer ne suffit pas.

%Il celui sur lequel repose le plus de poids puisque tout en découle.
%De plus il est commun a toute les disciplines scientifique.
%Il n'est pas de science possible sans observation.

\paragraph{La théorie} est le deuxième piliers.
%Lorsque l'on voit ces lumière sur la voûte céleste, nous sommes obligé de nous poser la question essentielle de leur provenance.
%Cette question mène a l'élaboration de diverse formulation tentant d'expliquer comment (et pourquoi) le ciel s'illumine la nuit.  
%Dans le cadre de l'étude de l'univers dans sont ensemble, cette théorie est nommée cosmologie et repose sur des concept mathématiques complexes
L'objectif est ensuite de réussir à donner un sens aux informations récoltées et de prédire les prochaines observations.
%Au fil des siècles, diverses théories ont été élaborées pour expliquer le comportement de l'Univers observable.
En effet, la force d'une théorie est jugée à sa capacité à faire des prédictions.
%A partir de la théorie, on réalise un modèle, un ensemble de règles  permettant de définir l'évolution d'un système connaissant son état actuel.

\paragraph{L'expérience} est le dernier pilier.
D'une manière générale, l'expérience a pour but de mettre a l’épreuve la théorie, et représente un ensemble d'actions, réalisées en suivant un protocole, permettant d'obtenir des résultats reproductibles.
A l'inverse d'autres domaines scientifique, en astrophysique notre portée d'interaction est réduite.
Il ne nous est ni possible d'effectuer des expériences sur l'Univers, ni de changer notre point d'observation.
Les simulations numériques permettent de palier à ces problèmes en créant virtuellement des portions d'espace respectant un certain modèle.
Un modèle, étant un ensemble de règles, issues de la théorie et permettant de définir l'évolution d'un système en connaissant son état actuel.
%Pilier le plus récent il est sensé palier au problème des deux autres : l'impossibilité de changer de point de vue ou de tester les théories élaborées.
%Ici sous entendue la simulation numérique, il est beaucoup plus récente et dépend grandement de la technologie.
%C'est celui vers lequel j'ai choisis de me diriger.

%observation, modélisation et test de la théorie or en astro on ne peut pas tester directement donc on simule.

\paragraph{}

Cette thèse est articulée principalement autour du dernier pilier.
Une grande partie de cette thèse a été consacrée à l'élaboration d'un modèle numérique dédié à l'étude de la réionisation.
Puis, dans le but d'explorer ce modèle, un nombre important d'expériences (de simulations) ont été réalisées.
Dans cette première partie, je vais introduire quelques grands concepts liés a l'étude numérique de la réionisation, puis je présenterai la structure du présent manuscrit en m'appuyant sur ces concepts.

\subsection*{Le modèle standard}

Notre compréhension actuelle de l'Univers s'inscrit dans le cadre du modèle standard de la cosmologie.
Ce modèle repose sur un Univers non statique et en expansion, ayant une origine, le Big-Bang.
À une époque, l'Univers était extrêmement chaud et dense, il n'y avait alors ni étoiles ni galaxies.
Mais sous l'effet de l'expansion, le plasma primordial s'est refroidi, les premiers atomes se sont formés lors de ce que l'on nomme la recombinaison, qui a mené à l'émission du fond diffus cosmologique.
L'Univers était alors extrêmement homogène que ce soit en densité ou en température, mais cette homogénéité n'était pas parfaite.
S'en suit une période où les in-homogénéités primordiales se sont effondrées sur elles même du fait de la gravité.
Puis, environ trois cents millions d'années après le Big-bang ces in-homogénéités sont devenues suffisamment denses pour former les première étoiles.
%Ces étoiles ont émis un rayonnement suffisamment énergétique pour séparer les électrons et les protons liés au moment de la recombinaison.
%L'univers c'est alors retrouvé une nouvelle fois dans un état majoritairement ionisé : c'est ce que l'on nomme la réionisation.

\subsection*{La réionisation}
%La réionisation constitue le dernier grand changement que l'univers ai subit lorsqu'il était âgé de moins d'un milliard d'années.
L'effondrement gravitationnel du gaz qui a permit par endroits une élévation de densité et de température suffisante pour réamorcer des réactions de fusion thermonucléaire est à l'origine de la formation de la première génération d'étoiles.
%Il s'agit de la première génération d'étoiles.
%Le matériaux disponible pour leurs formations était alors abondant.
%On pense que ces étoiles étaient beaucoup plus massives, et donc beaucoup plus énergétique que les étoiles observées actuellement.
Cette première génération à émis un fort rayonnement ultraviolet qui a grandement impacté le milieu environnant, en le chauffant et en l'ionisant. % par effet thermique et en le déplaçant par effet de pression de radiation.
De plus, à la fin de leur vie, ces étoiles massives ont explosé en supernovæ, effectuant alors un puissant chauffage ainsi qu'un fort brassage du gaz.
En changeant la configuration du milieu, ces premières étoiles ont modelées les lieux d'apparition des générations suivantes et par effet de cascade a eu un impact sur la distribution de matière observée aujourd'hui.

%La vitesse de la lumière étant finie, il fallut un certain temps pour que les premiers rayons ionisant puisse atteindre tous les recoins de l'Univers. 
La réionisation n'est pas un processus instantané.
Il est estimé aujourd'hui que les premières étoiles sont apparues alors que l'Univers était âgé d'environ 300 millions d'années. 
Il fallut alors 700 millions d'années supplémentaires pour que le rayonnement remplisse l'Univers, situant ainsi la fin de la période de réionisation à environ un milliard d'années après le Big-bang.

%C'est cette transition entre un univers neutre et froid vers un univers chaud et ionisé que l'on appel l'époque de réionisation.
%L'apparition des première sources lumineuse a eu un impact sur la façon dont la matière c'est organisée pour former les galaxies.
%Il est probable que l'univers que l'on observe aujourd'hui, ai conservé les traces de cette grande époque de transition.

Une des difficulté à l'étude de la réionisation est l'époque à laquelle elle s'est produite. %on considère actuellement qu'elle a eu lieu dans le premier milliard d'année de l'univers.
Pour observer l'Univers jeune, il faut regarder loin, et les meilleurs télescopes actuels ne sont pas encore assez performants pour atteindre des époques aussi lointaines.
Il faudra attendre encore au moins une décennie avant la mise en place des prochaines générations de télescopes assez puissants pour observer les environnements de formation de ces premières sources lumineuses.

\subsection*{Les simulations numériques}
Pour étudier des phénomènes aussi fortement couplés que ceux considérés dans le cas de l'époque de réionisation, il est nécessaire d'avoir recours à des simulations numériques. 
Le but de ces simulations est de reproduire les observations sur la distribution de matière dans l'Univers.

Les premières simulations cosmologiques ne considéraient l'évolution que de la matière noire. %la composante non collisionnelle de la matière, ie .
Comme celle ci constitue la masse la plus abondante de l'Univers, ces simulations permettent de suivre l'évolution de la distribution de matière sur les grandes échelles. 
Mais comme la matière noire est invisible, il manquait une composante importante : les baryons.
Lorsque l'intérêt fut porté sur la formation des galaxies, le calcul de l'hydrodynamique du gaz fut alors introduit, puis avec lui les premiers modèles de formation stellaire apparurent.
Mais la communauté a vite été confrontée a un important problème: le gaz refroidissait trop.
Ce qui menait à une formation d'étoile trop abondante car rien n’empochait le gaz de s’effondrer sur lui même.
Pour palier à ce problème, il fut proposé d'injecter de l'énergie dans les endroits les plus denses.
Cette énergie, introduite par les supernovæ, permet de chauffer le gaz et ralenti son effondrement. 
%Depuis très récemment, une troisième physique est devenue  dans les simulations l'influence de la radiation sur le milieu est également prise en compte.
Aujourd'hui, l'intérêt est porté sur l'introduction d'une nouvelle physique, celle du rayonnement.
Le rayonnement émit par les étoiles, va changer les propriétés physico-chimique et thermique du gaz qui les environnent et ainsi modeler les lieux d'apparitions des générations futures d'étoiles.

Même si les possibilités d'observations sont restreintes, nous pouvons utiliser les simulations numériques pour tenter de comprendre les phénomènes en cours à cette époque.
En effet, les phénomènes en action pendant la réionisation sont nombreux et les modèles analytique trouvent leurs limites.
%Avec l'avancée exponentielle des capacités de calculs, les ordinateurs se transforme petits a petit en véritable laboratoire pour les astrophysiciens.
A l'heure actuelle, il commence à être possible de simuler de manière auto cohérente, l'effondrement de structures cosmologiques, contenant du gaz, formant des étoiles, qui émettent du rayonnement.
Ces simulations ont pour objectif d'aider à comprendre quelques unes des grandes questions en suspend dans l'étude de la réionisation.
Voici un aperçu de ces questions : 

\begin{itemize}
\item Quand sont apparues les premières sources lumineuses?
Nous verrons que les observations imposent certaines contraintes sur la fin de la réionisation mais nous n'avons actuellement que  très peu de contraintes sur la durée du processus.

\item L'Univers a t-il été réionisé par quelques grosses sources très lumineuses ou par de nombreuses sources moins énergétiques ?
La question reste ouverte de savoir si se sont les quasars, sources relativement rares mais pouvant être extrêmement énergétiques, ou les galaxies plus modestes mais beaucoup plus nombreuses?
Dans le cas où se serait les galaxies, serait-ce les plus légères, extrêmement nombreuses ou les plus massives?

\item Comment ces premières générations d'étoiles ont influencées l'apparition des suivante, et ont elles laissées des traces encore visibles dans l'environnement proche?

\end{itemize} 

En répondant à certaines de ces questions, les simulations numériques permettent de mieux cibler les futures missions d'observations, et augmentent les chances de réussites.

%En étudiant au préalable ce que l'on cherche à observer, on a plus de chance d'observer au bon endroit et de la bonne facon.

%Au stade actuel de notre compréhension de l'univers, les simulations numériques ont a la fois de très belles réussites mais souffres également de 

%\subsection*{Le groupe local}
%Le groupe local est un ensemble de quelques dizaines de galaxies, dont les principales représentantes sont la Voie Lactée et notre voisine Andromède.
%Il s'agit de notre environnement galactique proche.
%Ce qui le rend facilement observable.
%L'observation de cet environnement nous fournis des informations essentielles sur la cosmologie de l'Univers.
%
%Plus la precision des observations augmente, plus il est nécessaire d'avoir des simulations résolues disposant de toutes la physique nécessaire pur expliquer globalement les échelles considérées.
%Les premières simulations de matière noires ont permit d'expliquer les observations réalisées sur la distribution de la matière aux grandes échelles.
%Lorsque les capacité de calcul se sont révélées suffisantes pour explorer des résolutions plus fines, il est vite apparu un certain décalage entre simulation et observation. 
%L'introduction de l'hydrodynamique a permis d'augmenter l'accord entre les deux, jusqu'à un second palier de résolution.
%Aujourd'hui, l'introduction de la physique du rayonnement va certainement permette de diminuer encore les échelles auxquelles les simulations sont sont en accord avec les observations.
%L'ordre de grandeur de ces échelles est celui de la taille du groupe local.
%
%De plus, les échelles que l'on considère dans les simulations cosmologiques a rayonnement couplé se rapproche de plus en plus des échelles considérés dans les simulations d'évolution de galaxies.
%L'objectif est ici de faire le lien entre la physique de l'univers dans son ensemble (la cosmologie) et de la physique régissant l'évolution de notre galaxie ou de sa voisine (la physique galactique).


\section{Mes travaux}

Dans l'objectif de répondre à certaine de ces questions, il est nécessaire de développer des outils.
EMMA à été mon principal outil durant cette thèse, j'y ai apporté différentes contributions, allant de l'ajout de nouvelles fonctionnalités jusqu'à la simple résolution de conflits, en passant par l'optimisation de certaine parties.

\textit{Comment la retro action stellaire impacte la formation des galaxies dans les simulations?}

Une de mes principales contributions a été l'implémentation d'un modèle de formation et d'évolution stellaire et une étape importante de cette thèse a été sa calibration..
Ce modèle dispose de plusieurs paramètres libres, et leurs valeurs étant directement fonction de la résolution, il a naturellement été choisi d'utiliser la résolution des plus grosse simulations à l'heure actuelle.
Cette calibration a été une étape préliminaire à la réalisation de la simulation CODA I-AMR, une simulation représentant un volume de $(100 cMpc)^3$ échantillonné par $2048^3$ éléments de résolutions et une résolution adaptative allant jusqu'à 500pc.
%Les ressources de calculs étant limitées, il est nécessaire de faire certaines concessions, le choix doit être fait entre volume physique et résolution.
Les ressources de calculs étant limitées, il n'est pas possible de réaliser plusieurs de ces simulations, j'ai exécuté un grand nombre de simulations de taille réduite à $(12 cMpc)^3$ avec une résolution similaire. 
L'objectif est d'explorer une partie de l'espace de paramètres du modèle, et de comprendre, sur des échantillons, quel est l'influence des paramètres libres sur les résultats obtenus, et leur interprétation dans des simulations plus grandes.



Pour analyser les nombreuse simulations obtenues dans de bonnes conditions, j'ai développé une librairie pour d'analyse et la gestion des données.
Cette librairie rassemble une grandes part des outils d’analyse que j'ai développé et est en accès libre, pour faciliter l'accès d'EMMA à ses nouveaux utilisateurs.
%visu

\textit{Comment améliorer un code de simulation cosmologique pour faire des simulations plus grosses et mieux résolues ?}

Dans l'objectif de diminuer les concessions à réaliser sur la taille et la résolution des simulations, il existe différentes pistes : soit augmenter l'accès aux ressources de calculs, soit optimiser les codes de simulations.
Un des mes objectif est de mieux cerner l'ensemble d'un tel code pour être en mesure de cibler les points à améliorer.

Il existe par exemple une technique consistant a diminuer numériquement  la vitesse de la lumière pour réduire la charge de calcul
Je me suis poser la question du domaine de validité de cette approximation.
Quel gain maximum peut on espérer grâce a cette technique, tout en restant dans un domaine d'approximation raisonnable?

\textit{Quels sont les facteurs qui limitent la performance globale de EMMA et comment les améliorer?}

Une autre piste n'est pas algorithmique mais matérielle.
L'utilisation de processeurs graphique permet dans certain cas des accélération considérable (jusqu’à deux ordre de grandeurs).
Cependant l'utilisation de ce matériel impose certaines précaution et si une grande partie d'EMMA l'utilise déjà, le potentiel d'accélération reste grand.






\section{Organisation du manuscrit}
%\begin{itemize}
%\item Introduction au   cosmologique $\Lambda$ CDM et a la période de réionisation.
%\item Présentation du model numérique (Papier emma)
%\item Présentation du model d'étoiles (papier SN)
%\item Présentation de l'outils des cartes de reionization (papier c)
%\item 
%\end{itemize}

Ce manuscrit est articulé autour de différents travaux auquel j'ai contribué pendant ma thèse.
Après le présent chapitre introductif, la première partie sera consacrée à la mise en place du contexte.
Le chapitre \ref{ch:introduction_physique} constitue une introduction aux concepts utiles en cosmologie.
Ces concepts seront nécessaires pour aborder le chapitre \ref{sec:introreio} qui explore plus spécifiquement la période de réionisation.
Une fois les grandes lignes du modèle physique introduites, et le contexte de la réionisation posé, j'aborderai mes travaux.
Je m'appuierai sur chacune des publications auxquelles j'ai contribué, et articulerai un chapitre autour de chacune d'elles. 
Une partie sera consacrée à EMMA, un code capable de simuler l'évolution de la matière noire, du gaz et de la radiation à des échelles cosmologiques de manière entièrement couplé, et ayant pour principal objectif l'étude de la période de réionisation.

Je commencerai dans le chapitre \ref{ch:introduction} par présenter les grandes lignes de \emma, et présenterai sa maille adaptative qui contraindra plusieurs choix par la suite.
Le chapitre \ref{sec:solvers} sera consacré au développement des différents moteurs physiques et de leurs concepts numériques associés.
Puis dans le chapitre \ref{sec:materiel}, l'accent sera mis sur les techniques de parallélisation utilisées dans EMMA qui a la particularité d'être massivement parallèle et d'être accéléré par processeurs graphiques.
Cette approche permettra au lecteur de mieux appréhender les résultats obtenus à partir des simulations générées ensuite avec ce code.

Comme l'étude du rayonnement émis dans l'Univers passe immanquablement par l'étude de la formation stellaire, je consacrerai le chapitre \ref{sec:etoiles} à détailler le modèle de formation et d'évolution stellaire de EMMA, ainsi que ses contraintes, ses limites, et les différents tests qui ont été exécutés pour sa calibration.

Je présenterai ensuite dans le chapitre \ref{sec:galaxies} une étude que j'ai menée à l'aide de ce modèle, visant à mieux comprendre la physique à l'œuvre dans les grandes simulations de la réionisation.
L'objectif est de comprendre quelles sont les galaxies qui contribuent à la réionisation dans nos modèles et quel est l'impact du feedback stellaire sur cette contribution.

Les chapitres \ref{sec:intre:zreio} et \ref{sec:lightspeed} seront consacrés à une étude sur l'influence de l'approximation de la vitesse de la lumière réduite sur la propagation des fronts d'ionisation.
Nous verrons que dans les simulations de la reionisation, la vitesse de la lumière peut être changée de manière a économiser du temps de calcul.
J'ai cherché a quantifier dans quelle mesure celle ci peux être réduite avant que cela ai un impact sur les résultats des simulations.
Pour cela j'ai développé un méthode pour calculer la vitesse des fronts d'ionisation, en utilisant les cartes de réionisation.

Nous verrons ensuite un court chapitre \ref{sec:CODAEMMA} dédié à la présentation de la simulation "CODA II EMMA", une des plus grosse simulation de la réionisation à l'heure actuelle.
J'y présenterai les premiers résultats obtenus à propos du liens entre la masse des halos contenus dans la simulation aujourd'hui et leurs histoires au moment de la réionisation.

Le chapitre \ref{sec:visu} sera consacré à la présentation de travaux liés à la visualisation des simulations cosmologiques.
J'y aborderai différentes méthodes de visualisations ainsi que quelques détails technique liés à leurs implémentations.


%Ce modèle constitue une de mes principale contributions à \emma.
%J'ai implémenté dans \emma, un modèle de transformation du gaz en particule stellaire.
%Ce modèle se base sur un critère de densité pour 
%Lorsque, sous l'effet de la gravitation, une cellule devient suffisamment dense, celle ci devient autorisée à former des étoiles.
%Toute les cellules autorisées vont alors transformer une certaine quantité du gaz en particule stellaire, en fonction de l'état local de la cellule, et suivant une loi empirique issue de l'observation : la loi de Schmidt-Kennicutt.
%Les particules nouvellement créées vont alors émettre du rayonnement ionisant pendant un certain temps.
%A la fin de leurs vie, ces particules stellaires vont exploser en supernovæ, injectant ainsi une quantité non négligeable d'énergie dans le milieu environnant.
%Cette énergie supplémentaire perturbe le milieu et régule la formation stellaire.
%J'ai implémenté différents modèles d'injection d'énergie dans le solveur hydrodynamique d'\emma{ } et comparé ces modèles entre eux. 

%Comme ces modèles nécessite l'introduction de plusieurs paramètres libres, une partie importante du temps a été consacrée à l'exploration et à la calibration de ces paramètres.


%Ce modèle considère deux types d'énergie. 
%La première, thermique, va dissiper une certaine partie de l'énergie disponible dans le chauffage du gaz.
%La seconde, cinétique, va mettre en mouvement le gaz environnant avec le reste de l'énergie.
%Une certaine proportion de la masse de la particule stellaire est retournée dans le milieu. 
%L'énergie totale et la masse des éjectas étant contrainte par un autre modèle, Starburst99.



%J'ai contribué à différents aspects du code mais une de mes 
%Au moment de mon arrivé en thèse,
%D'une manière plus générale j'ai contribué à divers aspect du code, comme la gestion des paramètres utilisateur, l'écriture des données de sorties ou encore la documentation.
%Dans la première partie de ma thèse, ma tache principale a été d'implémenter un scénario de formation stellaire, ainsi qu'un modèle de feedback de supernovae.
%Je développe également une librairie d'analyse des fichiers générés par \emma.


%J'ai également contribué au développement d'un code de visualisation et d'exploration de simulations astrophysique.


%
%\subsection*{Mod\`ele de formation stellaire}

%
%\subsection*{Mod\`ele de supernovae}
%
%Historiquement, les modèles de formation stellaire se sont rapidement confronté à un problème majeur : ils n'arrivaient pas à reproduire les observations en terme de quantité d'étoiles crées.
%Une réponse à ce problème fut l'introduction des supernovaes. 

%
%De la même manière que précédemment, l'implémentation de ce modèle a introduit plusieurs paramètres libres qu'ils a fallut calibrer.
%
%A partir de ce modèle numérique j'ai ensuite réalisé plusieurs études:
%
%\begin{itemize}
%\item en faisant varier le modèle de feedback stellaire j'ai tenté de quantifier son influence sur le déroulement du processus de réionisation.
%\item J'ai étudié la vitesse de propagation des fronts d'ionisations et montré que le reionisation s'éffectue en 2 phases. 
%\item Le develloppement de ce modèle a conduit a la réalisation de l'une des plus grosses simulations de la réionisation a l'heure actuelle la simulation CODA-EMMA.
%J'introduirais cette simulation ainsi que les premiers résultats obtenus.
%\item Enfin, je présenterai mes travaux concernant la visualisation de données de simulations.
%\end{itemize}
%
