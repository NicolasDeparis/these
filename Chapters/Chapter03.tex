\chapter{La composante stellaire}

définition d'une étoile\\

Maintenant que nous avons survolé toutes les physiques a l’œuvre dans ce type de simulation, concentrons nous sur les sources lumineuse.
comme nous avons vu, il existe deux types de sources, les étoiles et les quasars. %TODO ref
Je n'ai considérer que la partie stellaire.



\section{Les differentes phases de la vie d'une étoile}

le diagram HR


La nucléosynthèse primordiale a créer peu de métaux. 
A haut redshift, les metaux etaient peu disponible.
les métaux permettent une meilleur emmission radiative, et donc un meilleur refroidissent.
si le refroidissment est meilleur, l'equilibre hydrostatique penche an faveur de plus grosse étoiles.
POPIII, IMF top Heavy, étoiles  primordiales

plus un étoiles est grosse, plus son spectre sera énergétique et plus la portion de spectre ionisant sera important.

A la fin de se vie, une étoile a consommée la plus grande partie de son hydrogène disponible.
l'équilibre radiatif est rompu et l'étoile s'éffondre.
cette augmentation de la pression amorce une serie de fusion nucléaire d’élément plus lourd que l’hydrogène.
cycle CNO
Une fois arrivé au Fe, il devient coûteux de continuer a fusionner.
FE le plus stable



Géante rouge

En fonction de la masse:
naine blanche (pression de dégénérescence des électrons)
etoile a neutron (pression de dégénérescence des neutrons)
trou noir (singularité)



Différents type de supernovae

I -> binaire accrétante du compagnon -> passage au dessu de la limite.
II -> l'étoile est assez massive au départ (M>8Mo)


Les supernovae ont été introduite dans les simulations cosmologiques pour contre ballancer "l'overcooling probleme".
Sans l'introduction d'énergie dans le gaz par les supernovae, le gas s'éffondre de manière importante et créer un nombre élevé d'étoiles.
cela mène a un taux de formation stellaire trop important par rapport a ce qui est observé.



les superbubbles
A la manière de la percolllation des bulles de HII, les bulles de supernovae 








Les étoiles se trouvent aux centre de la simulation.
Le probleme du modèle sous grille
// concept de particule puits 
En effet, créer une étoiles consiste a transformer une partie du gaz en particule.
Cette particule sera ensuite gérée par le solveur Ncorps, et servira de source au solveur radiatif.
a la fin de sa vie, l'étoile va injecter de l'énergie dans le solveur hydro.


Seul la partie du spectre capable de ioniser l'hydrogène est considérée. E>13.6eV

\subsection{naissance}
effondrement hierarchique\\

masse de Jeans
lien entre vitesse du son et vitesse de chute libre
si la vitesse de chute libre est supérieur a la vitesse du son, le milieu n'a pas le temps de répondre a son effondrement, la gaz s'effondre et forme une étoile.

\begin{equation}
t_{sound} = \frac{R}{C_s}
\end{equation}

\begin{equation}
t_{ff} = \frac{1}{\sqrt{G \rho}}
\end{equation}

\begin{equation}
t_{ff} = t_{sound}
\end{equation}




lien avec la densité\\

Formation dans l'H moléculaire mais pas dans les simu

\subsection{Pop III}


a haut redshift:

TRes peux de métaux
tres peu de ligne de refroisdissment
étoiles plus grosse
 temps de vie court




\subsection{sequence principale}
majore partie du temps\\

equilibre hydrostatique entre gravitation et reaction de fusion nucléaire nucléaire\\

equation simplifié du processus de fusion:
\begin{equation}
4p \leftrightarrow He^4 + 2e+ + 2\nu + E
\end{equation}

%develloper le cycle proton proton ?



materiaux de base est l'hydrogene\\
plasma donc hydrogène ionisé 


\subsection{mort}
Consomation du materiaux de base

géante rouge\\
naine blanche\\
trou noir\\
supernovae\\
formation d'elements lourd (>Fe)
enrichissement du milieu



lien entre les différents solveurs en fonction du stade évolutif

En fonction des echelles de travail, nous considererons soit les etoiles individuelles soit une population stellaire.

\section{les modèles de population stellaire}

\subsection{Fonction de masse Initiale}
notion de population stellaire

Salpeter
Krupa

Fonction de masse IMF Top Heavy

durant les calibrations: difficulté a reioniser avec Salpeter -> passage a top heavy -> justification 

\subsection{starburst99}
paramètre d'entrée
sorties



\section{La formation stellaire}

\subsection{La loi de schmidt-kennicut}
Loi observationnelle \\
conversion densité surfacique vers densité 3D\\
rho 1.5\\
temps de free fall\\

Seuil en densité \\
\begin{equation}
	flag = 
  \begin{cases}
      True, & \text{if } \rho > \rho_{thresh}\\
      False,              & \text{otherwise}
  \end{cases}
\end{equation} 




\begin{equation}
	\rho_{thresh} = max\left(  \delta_{in} \bar{\rho}, \rho_{in} a^3 \right)
\end{equation} 

ou $\delta_{in}$ et $\rho_{in}$  sont respectivement les paramètre de surdensité et de densité physique.
$\delta_{in}$est exprimé en unité comobile et est donc constant dans le temps en unité du code
 $\rho_{in}$ est exprimé en unité physique (en atome par metre cube), sa valeur evolue dans le temps du point de vue des unité du codes.

determination de la valeur de 55\\ 
 
 
Dans les cellules au dessus du seuil on considère une SFR de:

\begin{equation}
	SFR = \epsilon \frac{\rho_g}{t_{ff}}
    \label{eq_sfr}
\end{equation}


avec  $\epsilon$ le paramètre d'efficacité de formation stellaire , $\rho_g$ la densité de gaz locale, et le temps de chute libre:
\begin{equation}
t_{ff} = \sqrt{\frac{3\pi}{32G\rho_g}}
\end{equation}

\begin{equation}
	M_{star} = SFR . dv .dt 
\end{equation}

resolution en masse\\

Nous avons donc a ce stade la masse totale de gaz a convertir en étoile.
Il peux etre tres couteux de générer pour chaque cellule éligible, et a chaque pas de temps, une nouvelles particule stellaire (le nombre de particule peux rapidement exploser.
Nous adoptons une approche probabiliste.
Nous définissons une masse d'étoiles $m_{star}$ qui correspondra a notre "quanta stellaire".
toutes les étoiles aurons donc la même masse.
Et nous tirons le nombre de quanta a ajouter aléatoirement dans une lois de Poisson.

\begin{equation}
	P(N) = \frac{\lambda^N}{N!} e^{-\lambda}
\end{equation}

Ou $\lambda$ correspond au nombre de particule moyen a créer dans la cellule ($\lambda \frac{ M_{star}}{m_{star}}$
Étant donné le grand nombre de tirage cette loi est en moyenne valide.

La masse des étoiles est calculée d'une manière comparable a la masse d'une particule de matière noire.
la masse d'une étoile correspond a la masse moyenne de gaz dans une cellules d'un certain niveau pouvant aller du niveau coarse $m_star = M_{DM} \frac{\Omega_b}{\Omega_m}$ au niveau plusieurs niveau raffiné.


LEs étoiles créées auront une vitesse aléatoire pour éviter les effets de "collier".




\section{La vie radiative}
%injection d'énergie dans le solveur radiatif, ok mais combien?\\
%calibration energetique et Starburst99\\

Une fois les étoiles formées, il est nécessaire de les faire rayonner.
Pour ce faire il faut passer en revue toute les étoiles, et a partir de leurs masse et de leur age, calculer leurs émissivité.
Cette opération est simplifiée par l'utilisation de la liste chaînée de particule associées a chaque cellule. %TODO ref section
En effet, en pratique, on passera en revue toutes les cellules, et pour chaque cellules on passera en revue toutes ses particules.
On testera alors si une particules est une étoiles (la liste chainée contient également les particulke de matière noire), et si cette étoiles est dans un stade ou elle émet de l'énergie lumineuse.
Si c'est le cas, on calculera sont émissivité et ont injectera cette énergie sous forme de source dans l'équation \ref{eq:densite_energie}.
Le calcul de $\dot{N}_\nu^*$ sera effectué dans toutes les cellules.

La principale question a la quelle tente de répondre cette section est : Quel est le lien entre age, masse et luminosité d'une particule stellaire?
Pour répondre a cette question on utilisera un modèle de population stellaire.

Il existe différent modèles, j'ai choisi d'utilisé Starburst99 \citep{leitherer_starburst99:_1999}. %TODO mettre les differnts models

A partir d'information caractéristique d'une population stellaire, comme sa masse, son IMF ou sa métallicité, Starburst99 retourne le spectre d'émission de cette population en fonction du temps cf (Fig \ref{fig:spectre_starburst}).

\begin{figure}[htbp]
        \includegraphics[width=.95\linewidth]{img/03/spectre_starburst.jpg} 
        \caption{Spectre d'émission d'une population stellaire gégéré par Starburst99.
        Ici avec les paramètres M=1e6 Mo, IMF Salpeter alpha 2.35 de 1 a 100Mo }
 		\label{fig:spectre_starburst}
\end{figure}

A partir de ces spectres, nous allons ne garder que la partie capable de ioniser l'hydrogène (toutes les longueurs d'onde plus petite que 911$\AA$) 



\begin{equation}
E_{ion} = \int_{13.6eV}^{+\inf} h \nu d\nu
\end{equation}

On obtient a partir de cette intégration, un profil de luminosité présenté sur la figure \ref{fig:flux}.

\begin{figure}[htbp]
        \includegraphics[width=.95\linewidth]{img/03/flux.pdf} 
        \caption{Émissivité ionisante intégrée en fonction du temps}
 		\label{fig:flux}
\end{figure}

Le profil obtenu présente un plateau d'émissivité constante suivie d'une rapide décroissance.
Ce profil peut être raisonnablement approximé par:

$
    S = 
\begin{cases}
    S_0 ,         & \text{if } t < t_{life}\\
    S_0.t^{-4},   & \text{if } t_{life} \leq t < 100.t_{life} \\
    0,   & \text{if } 100t_{life} \leq t
\end{cases}
$

Ce flux correspond au flux d'une population de $10^6M_\odot$.
Ces valeurs seront pondérées au prorata de la masse de la particule stellaire. (Une particule de $10^5M_\odot$ émettra 10 fois moins de photons).


Ce profil d’émission ionisante peut être découper en différents "groupe de photons" (cf section \ref{sec:groupedephotons}).
Il est possible de choisir un nombre arbitraire de groupes, mais il faut prendre en compte que chaque groupe devient l'équivalent d'un fluide dont on veut suivre l'évolution.
Le coût numérique augmente rapidement avec le nombre de groupes. 
J'ai implémenté la possibilité de découper les groupes, en fréquences, mais aussi en temps.
Malgré tout, le ratio cout de calcul sur amélioration des prédictions n'est pas en faveur de l'augmentation du nombre de groupes (dans le cas des résolution considérée pendant ma thèse).
En pratique on prendra un généralement un seul groupe de photons.

L’énergie moyenne d'un photon dans un groupe est calculée de la manière suivante:
\begin{equation}
<E> = \frac{1}{N} \int_{\nu_1}^{\nu_2} N_\nu h \nu d\nu
\end{equation}

et la section efficace d'intéraction:
\begin{equation}
\sigma_E = \frac{1}{N<E>} \int_{\nu_1}^{\nu_2} N_\nu h \nu d\nu
\end{equation}

Pour une IMF TopHeavy, les valeurs obtenues sont:


\begin{table}
\begin{tabular}{l l }
	$<h\nu>$	&  23.42 eV \\
	$\alpha_e$	&  $2.35.10^{-22}$ m$^2$ \\
	$\alpha_i$	&  $1.82.10^{-22}$ m$^2$ \\
\end{tabular}
\caption{Propriété des photon émis par les sources.
\label{tab_photon}}
\end{table}

Tab \ref{tab_photon} caractéristique des photons.


%intégration de l'énergie et de la section efficace


%We found a mean energy of $<h\nu> = 23.42$ eV,
%an energy weighted cross section of
%$\alpha_e = 2.35.10^{-22}$ m$^2$
%and a number weighted cross section of
%$\alpha_i = 1.82.10^{-22}$ m$^2$





Masse de la population\\
produit en croix pour correspondre a la masse dans simu\\
integration seulement sur energy ionisante\\

Multigroupe frequence\\
multigroup temporel\\


\section{le problème de la masse des étoiles}

le paramètre de masse des étoiles change la reionization\\
effet numérique\\
le rayonnement est piégé dans les cellules\\


\input{Chapters/Chapter03_supernovae.tex}



